<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="icon" href="{{ url_for('static', filename='images/favico.png') }}" type="image/x-icon">
    <title>Wellness Wave-Early Lifestyle Diseases Prediction & Precaution</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
             background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), /* dark overlay */ 
            url("{{ url_for('static', filename='images/herosection.png') }}");
        }
        .form-container {
            max-width: 600px;
            margin: 50px auto;
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

         header{
            position: fixed; top: 0; width: 100%; z-index: 1050;
        }

        .step-progress-bar {
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            margin-bottom: 25px;
        }
        .step-progress-bar-fill {
            height: 100%;
            background-color: #0d6efd;
            border-radius: 4px;
            transition: width 0.5s ease-in-out;
        }
        .step-content {
            display: none;
        }
        .step-content.active {
            display: block;
        }
        .form-control:focus {
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
            border-color: #0d6efd;
        }
        h2 {
            color: #343a40;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
 <!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="container" style="margin-top:50px;">
      {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show flash-msg" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}
</header>
    

<div class="container">

    <div class="form-container" style="height: 700px;">
        
          <!-- Close Button -->
    <button type="button" class="btn-close " aria-label="Close"
        onclick="window.location.href='{{ url_for('index') }}'" style="margin-top:0px; margin-left:500px"></button>

        <h2 class="text-center mb-4">Doctor Registration</h2>
        <div class="step-progress-bar">
            <div id="progressBar" class="step-progress-bar-fill" style="width: 0%;"></div>
        </div>

        <form id="multiStepForm" action="{{ url_for('doctor_register') }}" method="POST" enctype="multipart/form-data" novalidate>
            <!-- Step 1: Personal Details -->
         <div id="step1" class="step-content active">
                <h3 class="mb-4">1. Personal Details</h3>
                <div class="mb-3">
                    <label for="email" class="form-label">Email address</label>
                    <input type="email" class="form-control " id="email" name="email" required>
                    <div class="invalid-feedback">Please enter a valid email address.</div>
                </div>
                <div class="mb-3">
                    <label for="fullName" class="form-label">Full Name</label>
                    <input type="text" class="form-control " id="fullName" name="name" required>
                    <div class="invalid-feedback">Please enter your full name.</div>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" class="form-control " id="password" name="password" required>
                    <div class="invalid-feedback">Password must be at least 6 characters.</div>
                </div>
                <button type="button" class="btn btn-primary float-end  px-4" onclick="nextStep(1)">Next</button>
            </div>

            <!-- Step 2: Professional Details -->
            <div id="step2" class="step-content">
                <h3 class="mb-4">2. Professional Details</h3>
                <div class="mb-3">
                    <label for="specialization" class="form-label">Specialization</label>
                    <input type="text" class="form-control " id="specialization" name="specialization" required>
                    <div class="invalid-feedback">Please enter your specialization.</div>
                </div>
                <div class="mb-3">
                    <label for="qualification" class="form-label">Qualification</label>
                    <input type="text" class="form-control " id="qualification" name="qualification" required>
                    <div class="invalid-feedback">Please enter your qualification.</div>
                </div>
                <div class="mb-3">
                    <label for="experience" class="form-label">Experience (in years)</label>
                    <input type="number" class="form-control " id="experience" name="experience" required>
                    <div class="invalid-feedback">Please enter your years of experience.</div>
                </div>
                <div class="mb-3">
                    <label for="registrationId" class="form-label">Doctor Registration ID</label>
                    <input type="text" class="form-control " id="registrationId" name="registration_id" required>
                    <div class="invalid-feedback">Please enter your registration ID.</div>
                </div>
                <button type="button" class="btn btn-secondary  px-4" onclick="prevStep(2)">Previous</button>
                <button type="button" class="btn btn-primary float-end  px-4" onclick="nextStep(2)">Next</button>
            </div>

            <!-- Step 3: Contact and Hospital Info -->
            <div id="step3" class="step-content">
                <h3 class="mb-4">3. Contact & Hospital Details</h3>
                <div class="mb-3">
                    <label for="hospital" class="form-label">Currently Working Hospital</label>
                    <input type="text" class="form-control " id="hospital" name="hospital" required>
                    <div class="invalid-feedback">Please enter your hospital name.</div>
                </div>
                <div class="mb-3">
                    <label for="phoneNo" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="phoneNo" name="phone" pattern="\d{10}" required>
                    <div class="invalid-feedback">Please enter a valid 10-digit phone number.</div>
                </div>
                <div class="mb-3">
                    <label for="address" class="form-label">Address</label>
                    <textarea class="form-control " id="address" name="address" rows="3" required></textarea>
                    <div class="invalid-feedback">Please enter your address.</div>
                </div>
                <div class="mb-3">
                    <label for="profilePic" class="form-label">Profile Picture Upload</label>
                    <input type="file" class="form-control" id="profilePic" name="profile_pic" required>
                    <div class="invalid-feedback">Please upload your profile picture.</div>
                </div>
                <button type="button" class="btn btn-secondary px-4" onclick="prevStep(3)">Previous</button>
                <button type="button" class="btn btn-primary float-end  px-4" onclick="nextStep(3)">Next</button>
            </div>

            <!-- Step 4: Summary and Submission -->
            <div id="step4" class="step-content">
                <h3 class="mb-4">4. Review & Submit</h3>
                <ul class="list-group mb-4">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Email:</span>
                        <span id="summaryEmail"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Full Name:</span>
                        <span id="summaryName"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Specialization:</span>
                        <span id="summarySpecialization"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Qualification:</span>
                        <span id="summaryQualification"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Experience:</span>
                        <span id="summaryExperience"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Registration ID:</span>
                        <span id="summaryRegistration"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Hospital:</span>
                        <span id="summaryHospital"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Phone No:</span>
                        <span id="summaryPhone"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Address:</span>
                        <span id="summaryAddress"></span>
                    </li>
                </ul>
                <button type="button" class="btn btn-secondary px-4" onclick="prevStep(4)">Previous</button>
                <button type="submit" class="btn btn-success float-end  px-4">Submit</button>
            </div>
        </form>
        
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    let currentStep = 1;
    const form = document.getElementById('multiStepForm');
    const steps = document.querySelectorAll('.step-content');
    const progressBar = document.getElementById('progressBar');

    function updateProgressBar() {
        const progress = (currentStep - 1) / (steps.length - 1) * 100;
        progressBar.style.width = `${progress}%`;
    }

    function validateStep(step) {
        let isValid = true;
        const currentStepForm = document.getElementById(`step${step}`);
        const inputs = currentStepForm.querySelectorAll('input, textarea');
        
        inputs.forEach(input => {
            if (!input.checkValidity()) {
                input.classList.add('is-invalid');
                isValid = false;
            } else {
                input.classList.remove('is-invalid');
            }
        });

        // Specific validation logic
        if (step === 1) {
            if (document.getElementById('password').value.length < 6) {
                document.getElementById('password').classList.add('is-invalid');
                document.querySelector('#password ~ .invalid-feedback').textContent = 'Password must be at least 6 characters.';
                isValid = false;
            }
        }
        
        return isValid;
    }

    function showStep(step) {
        steps.forEach(s => s.classList.remove('active'));
        document.getElementById(`step${step}`).classList.add('active');
        currentStep = step;
        updateProgressBar();
    }

    function nextStep(step) {
        if (validateStep(step)) {
            if (step === 3) {
                updateSummary();
            }
            showStep(step + 1);
        }
    }

    function prevStep(step) {
        showStep(step - 1);
    }

    function updateSummary() {
        document.getElementById('summaryEmail').textContent = document.getElementById('email').value;
        document.getElementById('summaryName').textContent = document.getElementById('fullName').value;
        document.getElementById('summarySpecialization').textContent = document.getElementById('specialization').value;
        document.getElementById('summaryQualification').textContent = document.getElementById('qualification').value;
        document.getElementById('summaryExperience').textContent = document.getElementById('experience').value;
        document.getElementById('summaryRegistration').textContent = document.getElementById('registrationId').value;
        document.getElementById('summaryHospital').textContent = document.getElementById('hospital').value;
        document.getElementById('summaryPhone').textContent = document.getElementById('phoneNo').value;
        document.getElementById('summaryAddress').textContent = document.getElementById('address').value;
    }

   form.addEventListener("submit", function (event) {
    // validate final step before submission
    if (!validateStep(currentStep)) {
        event.preventDefault(); // stop submission only if invalid
        return;
    }
    // ✅ Do NOT preventDefault here → let Flask handle it
});


    // Initial progress bar update
    updateProgressBar();
</script>
  <!--flash hide-->   
 <script>
  setTimeout(function () {
    const alerts = document.querySelectorAll(".flash-msg");
    alerts.forEach(function(alert) {
      const bsAlert = new bootstrap.Alert(alert);
      bsAlert.close();
    });
  }, 1000); 
</script>

</body>
</html>
